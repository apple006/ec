/*!
 * Copyright (c) 2012-2018 http://www.eryansky.com
 * <p/>
 * Licensed under the Apache License, Version 2.0 (the "License");
 */
$(document).ready(function(){try{$("a").bind("focus",function(){if(this.blur){this.blur()}})}catch(a){}});function include(c,m,e){if(document.getElementById(c)==null){var a=typeof e=="string"?[e]:e;for(var f=0;f<a.length;f++){var b=a[f].replace(/^\s|\s$/g,"");var h=b.split(".");var d=h[h.length-1].toLowerCase();var k=d=="css";var l=k?"link":"script";var g=k?" type='text/css' rel='stylesheet' ":" type='text/javascript' ";var j=(k?"href":"src")+"='"+m+b+"'";document.write("<"+l+(f==0?" id="+c:"")+g+j+"></"+l+">")}}}function getQueryString(b,a){var c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)","i");if(!a||a==""){a=window.location.search}else{a=a.substring(a.indexOf("?"))}r=a.substr(1).match(c);if(r!=null){return unescape(r[2])}return null}function getDictLabel(d,c,a){for(var b=0;b<d.length;b++){var e=d[b];if(e.value==c){return e.label}}return a}function windowOpen(d,c,e,a){var g=parseInt((window.screen.height-a)/2,10),f=parseInt((window.screen.width-e)/2,10),b="location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes,width="+e+",height="+a+",top="+g+",left="+f;window.open(d,c,b)}function resetTip(){top.$.jBox.tip.mess=null}function closeTip(){top.$.jBox.closeTip()}function showTip(d,b,c,a){resetTip();setTimeout(function(){top.$.jBox.tip(d,(b==undefined||b==""?"info":b),{opacity:0,timeout:c==undefined?2000:c})},a==undefined?500:a)}function loading(a){if(a==undefined||a==""){a="正在提交，请稍等..."}resetTip();top.$.jBox.tip(a,"loading",{opacity:0})}function alertx(b,a){top.$.jBox.info(b,"提示",{closed:function(){if(typeof a=="function"){a()}}});top.$(".jbox-body .jbox-icon").css("top","55px")}function confirmx(c,b,a){top.$.jBox.confirm(c,"系统提示",function(d,e,g){if(d=="ok"){if(typeof b=="function"){b()}else{resetTip();location=b}}},{buttonsFocus:1,closed:function(){if(typeof a=="function"){a()}}});top.$(".jbox-body .jbox-icon").css("top","55px");return false}function promptx(d,c,b,a){top.$.jBox("<div class='form-search' style='padding:20px;text-align:center;'>"+c+"：<input type='text' id='txt' name='txt'/></div>",{title:d,submit:function(e,g,i){if(i.txt==""){top.$.jBox.tip("请输入"+c+"。","error");return false}if(typeof b=="function"){b()}else{resetTip();location=b+encodeURIComponent(i.txt)}},closed:function(){if(typeof a=="function"){a()}}});return false}function addTabPage(e,a,d,c,b){top.$.fn.jerichoTab.addTab({tabFirer:c,title:e,closeable:d==undefined,data:{dataType:"iframe",dataLink:a}}).loadData(b!=undefined)}function cookie(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+m.path:"";var g=m.domain?"; domain="+m.domain:"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}}function pad(b,c){var a=b.toString().length;while(a<c){b="0"+b;a++}return b}function strToDate(a){return new Date(a.replace(/-/g,"/"))}function addDate(a,b){a=a.valueOf();a=a+b*24*60*60*1000;return new Date(a)}function abbr(a,e){if(!e){e=20}if(a==null||a.length<1){return""}var k=0;var l=0;var d=false;var j=false;var g;for(var f=0;f<a.length;f++){if(f>1&&j==false){d=false}if(f>1&&j==true){d=true}var h=a.charCodeAt(f);if((h>=1&&h<=126)||(65376<=h&&h<=65439)){k++;j=false}else{k+=2;l++;j=true}if(k>e&&f<=a.length-1){if(j==true&&d==true){g=a.substring(0,f-2)+"..."}if(j==false&&d==false){g=a.substring(0,f-3)+"..."}if(j==true&&d==false){g=a.substring(0,f-2)+"..."}if(d==true){g=a.substring(0,f-2)+"..."}break}}if(k<=e){return a}return g}function addFavorite(b,a){if(!a){a=document.title}try{window.external.addFavorite(b,a)}catch(c){try{window.sidebar.addPanel(a,b,"")}catch(c){alert("加入收藏失败，请使用Ctrl+D进行添加")}}}function autoScroll(b){var a=$(b).find("ul:first li:first").height()+3;$(b).find("ul:first").animate({marginTop:"-"+a+"px"},"slow",function(){$(this).css({marginTop:"0px"}).find("li:first").appendTo(this)})}function isCanvasSupported(){var a=document.createElement("canvas");return !!(a.getContext&&a.getContext("2d"))}var U={uploadImageFile:function(c){if(typeof FileReader=="undefined"||($.browser.safari&&navigator.userAgent.match(/AppleWebKit\/(\d+)/).pop()<534)){U.uploadImageFile2(c);return false}var g=c.quality;var e=c.maxWidth;var d=c.maxHeight;var f=c.callback;var b=c.error;var a=c.file.target.files;$.each(a,function(j,k){var h=new FileReader();h.onload=function(l){var i=l.target.result;if(i.lastIndexOf("data:base64")!=-1){i=i.replace("data:base64","data:image/jpeg;base64")}else{if(i.lastIndexOf("data:,")!=-1){i=i.replace("data:,","data:image/jpeg;base64,")}}if(isCanvasSupported()){U.compressImg(i,g,function(n){U.ajaxUploadBase64ImageFile(n,f)},e,d)}else{var m="您的客户端不支持文件上传";if(b){b(m)}}};h.onerror=function(){var i="上传失败";if(b){b(i)}};h.readAsDataURL(k)})},uploadImageFile2:function(b){var a=b.file.target.files;$.each(a,function(d,e){var e=b.file.target.files[0];var h=b.quality;var g=b.callback;var c=b.error;U.ajaxUploadImageFile(e,g,c)})},compressImg:function(f,g,e,d,c){if(!f){return}e=e||function(){};var b=document.createElement("canvas");var a=new Image();a.onload=function(){var i=b.getContext("2d");i.clearRect(0,0,b.width,b.height);var k=d||a.width;var j=c||a.height;if(a.width>k||a.height>j){var h=Math.max(a.width/k,a.height/j);b.width=a.width/h;b.height=a.height/h}else{b.width=a.width;b.height=a.height}i.drawImage(a,0,0,a.width,a.height,0,0,b.width,b.height);e(b.toDataURL("image/jpeg",g||1))};a.src=f},ajaxUploadBase64ImageFile:function(a,d,c){var b=appURL+"/m/base64ImageUpLoad";$.ajax({url:b,type:"post",data:{base64Data:a},dataType:"json",success:function(e){if(e.code==1){if(d){d(a,e.obj)}}else{if(c){c(e.msg)}}}})},ajaxUploadImageFile:function(c,e,b){var a=appURL+"/m/imageUpLoad";var d=new FormData();d.append("uploadFile",c);$.ajax({url:a,type:"POST",data:d,dataType:"json",processData:false,contentType:false,success:function(f){if(f.code==1){if(e){e(f.obj["data"],f.obj["file"])}}else{if(b){b(f.msg)}}}})}};